{"analysis.config":"ZmlsdGVyeyAKICBpZiAgKCAgW2NvbGxlY3RydWxlaWRdID09IDIgKSAgCiAKCnsKCiAgICBydWJ5ewogICAgICAgICMjIyMjI+S7o+eggeWkhOeQhiMjIyMjIwogICAgICAgIGlkPT4iMl80NCIKICAgICAgICBjb2RlPT4iCiAgICAgICAgICAgIGV2ZW50SGFzaCA9IGV2ZW50LnRvX2hhc2gKICAgICAgICAgICAgZXZlbnQuc2V0KCdvZmZzZXQnLGhhbmRsZU9mZnNldChldmVudEhhc2gpKQogICAgICAgICAgICBldmVudC5zZXQoJ3NvdXJjZScsIGhhbmRsZVNvdXJjZShldmVudEhhc2gpKQogICAgICAgIAogICAgICAgICAgICBkaW1lbnNpb25zID0gSGFzaC5uZXcKICAgICAgICAgICAgZGltZW5zaW9ucyA9IHsKICAgICAgICAgICAgICAgICdob3N0bmFtZScgPT4gaGFuZGxlSG9zdE5hbWUoZXZlbnRIYXNoKSwKICAgICAgICAgICAgICAgICdhcHBzeXN0ZW0nID0+ICBldmVudC5nZXQoJ2FwcHN5c3RlbScpLAogICAgICAgICAgICAgICAgJ2FwcHByb2dyYW1uYW1lJyA9PiBldmVudC5nZXQoJ2FwcHByb2dyYW1uYW1lJyksCiAgICAgICAgICAgICAgICAnc2VydmljZW5hbWUnID0+IGV2ZW50LmdldCgnc2VydmljZW5hbWUnKSwKICAgICAgICAgICAgICAgICdzZXJ2aWNlY29kZScgPT4gZXZlbnQuZ2V0KCdzZXJ2aWNlY29kZScpLAogICAgICAgICAgICAgICAgJ2NsdXN0ZXJuYW1lJyA9PiBldmVudC5nZXQoJ2NsdXN0ZXJuYW1lJyksCiAgICAgICAgICAgICAgICAnaXAnID0+IGV2ZW50LmdldCgnaXAnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBldmVudC5zZXQoJ2RpbWVuc2lvbnMnLGRpbWVuc2lvbnMpCiAgICAgICAgICAgICNnZXQgbWVhc3VyZXMKICAgICAgICAgICAgbWVhc3VyZUhhc2ggPSBIYXNoLm5ldwogICAgICAgICAgICBtZWFzdXJlSGFzaCA9IHt9CiAgICAgICAgICAgIGV2ZW50LnNldCgnbWVhc3VyZXMnLCBtZWFzdXJlSGFzaCkKICAgICAgICAgICAgI2dldCBub3JtYWxGaWVsZHMKICAgICAgICAgICAgb3RoZXJmaWVsZEhhc2ggPSBIYXNoLm5ldwogICAgICAgICAgICBvdGhlcmZpZWxkSGFzaCA9IHsKICAgICAgICAgICAgICAgICdjb2xsZWN0dGltZScgPT4gZXZlbnQuZ2V0KCdAdGltZXN0YW1wJykudG9fcywKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiBldmVudC5nZXQoJ21lc3NhZ2UnKQogICAgICAgICAgICAgICAgfQoJCQlvdGhlcmZpZWxkSGFzaFsnY29sbGVjdHRpbWVfMiddPShUaW1lLm5ldygpLTgqNjAqNjApLmlzbzg2MDEoMykudG9fcy5nc3ViKCcrMDg6MDAnLCdaJykKCQkJb3RoZXJmaWVsZEhhc2hbJ2xvZ3N0YXNoX2RlYWxfaXAnXT0nJHtMT0dTVEFTSF9IVFRQX0hPU1R9JwoJCQlvdGhlcmZpZWxkSGFzaFsnbG9nc3Rhc2hfZGVhbF9uYW1lJ109JyR7TE9HU1RBU0hfSU5TVEFOQ0VfTkFNRX0nCgkJCW90aGVyZmllbGRIYXNoWydzb3VyY2UnXSA9IGV2ZW50LmdldCgnc291cmNlJykKICAgICAgICAgICAgZXZlbnQuc2V0KCdub3JtYWxGaWVsZHMnLCBvdGhlcmZpZWxkSGFzaCkKICAgICAgICAgICAgZXZlbnQuc2V0KCd0aW1lc3RhbXAnLGV2ZW50LmdldCgnQHRpbWVzdGFtcCcpKQogICAgICAgICAgICAKICAgICAgICAgICAgIgogICAgICAgIGluaXQ9PiIKICAgICAgICAgICAgZGVmIGhhbmRsZU9mZnNldChldmVudEhhc2gpCiAgICAgICAgICAgICAgICBvZmZzZXQgPSAwCiAgICAgICAgICAgICAgICBvZmZzZXQgPSBnZXRIYXNoVmFsdWUoZXZlbnRIYXNoLCAnb2Zmc2V0Jywgb2Zmc2V0KQogICAgICAgICAgICAgICAgaWYgb2Zmc2V0ID09IDAKICAgICAgICAgICAgICAgICAgIGxvZyA9IGdldEhhc2hWYWx1ZShldmVudEhhc2gsICdsb2cnLCBIYXNoLm5ldykKICAgICAgICAgICAgICAgICAgIGxvZz1sb2cudG9faGFzaAogICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gZ2V0SGFzaFZhbHVlKGxvZywgJ29mZnNldCcsIG9mZnNldCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgcmV0dXJuIG9mZnNldAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIGRlZiBoYW5kbGVTb3VyY2UoZXZlbnRIYXNoKQogICAgICAgICAgICAgICAgc291cmNlID0gJycKICAgICAgICAgICAgICAgIHNvdXJjZSA9IGdldEhhc2hWYWx1ZShldmVudEhhc2gsICdzb3VyY2UnLCBzb3VyY2UpCiAgICAgICAgICAgICAgICBpZiBzb3VyY2UgPT0gJycKICAgICAgICAgICAgICAgICAgIGxvZyA9IGdldEhhc2hWYWx1ZShldmVudEhhc2gsICdsb2cnLCBIYXNoLm5ldykKICAgICAgICAgICAgICAgICAgIGxvZz1sb2cudG9faGFzaAogICAgICAgICAgICAgICAgICAgZmlsZSA9IGdldEhhc2hWYWx1ZShsb2csICdmaWxlJywgSGFzaC5uZXcpCiAgICAgICAgICAgICAgICAgICBmaWxlID0gZmlsZS50b19oYXNoCiAgICAgICAgICAgICAgICAgICBzb3VyY2UgPSBnZXRIYXNoVmFsdWUoZmlsZSwgJ3BhdGgnLCBzb3VyY2UpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICBkZWYgaGFuZGxlSG9zdE5hbWUoZXZlbnRIYXNoKQogICAgICAgICAgICAgICAgaG9zdG5hbWUgPSAnZW1wdHlIb3N0JwogICAgICAgICAgICAgICAgaWYgZXZlbnRIYXNoLmhhc19rZXk/KCdiZWF0JykKICAgICAgICAgICAgICAgICAgIGJlYXQgPSBnZXRIYXNoVmFsdWUoZXZlbnRIYXNoLCAnYmVhdCcsIEhhc2gubmV3KQogICAgICAgICAgICAgICAgICAgYmVhdD1iZWF0LnRvX2hhc2gKICAgICAgICAgICAgICAgICAgIGhvc3RuYW1lID0gZ2V0SGFzaFZhbHVlKGJlYXQsICdob3N0bmFtZScsIGhvc3RuYW1lKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBpZiBob3N0bmFtZSA9PSAnZW1wdHlIb3N0JyBhbmQgZXZlbnRIYXNoLmhhc19rZXk/KCdob3N0JykKICAgICAgICAgICAgICAgICAgIGhvc3QgPSBnZXRIYXNoVmFsdWUoZXZlbnRIYXNoLCAnaG9zdCcsIEhhc2gubmV3KQogICAgICAgICAgICAgICAgICAgaG9zdD1ob3N0LnRvX2hhc2gKICAgICAgICAgICAgICAgICAgIGhvc3RuYW1lID0gZ2V0SGFzaFZhbHVlKGhvc3QsICduYW1lJywgaG9zdG5hbWUpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIHJldHVybiBob3N0bmFtZQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBkZWYgZ2V0SGFzaFZhbHVlKHRhcmdldEhhc2gsIGtleSwgZGVmYXVsdFZhbHVlKQogICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWUKICAgICAgICAgICAgICAgIGlmIHRhcmdldEhhc2guaGFzX2tleT9rZXkKICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGFyZ2V0SGFzaC5mZXRjaChrZXksIGRlZmF1bHRWYWx1ZSkKICAgICAgICAgICAgICAgIGVuZCAgIAogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlCiAgICAgICAgICAgIGVuZAogICAgICAgIAogICAgICAgICIKICAgIH0KCn0KIAoKICAgIGlmICEoW2RpbWVuc2lvbnNdKSB7ZHJvcHt9fQoKCn0K","analysis.id":"2","collect.rule.ids":"2","data.type":"1","type.name":"default_analysis_template"}